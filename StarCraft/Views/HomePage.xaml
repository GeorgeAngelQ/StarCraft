<ContentPage
    x:Class="StarCraft.Views.HomePage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:model="clr-namespace:StarCraft.Models"
    xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.Maui;assembly=LiveChartsCore.SkiaSharpView.Maui"
    Title="BÃºsqueda de Enfrentamientos"
    BackgroundColor="#0F0F0F">

    <ScrollView>
        <Grid Padding="20" RowSpacing="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- SECCIÃ“N DE BÃšSQUEDA -->
            <Frame Grid.Row="0" 
                   BackgroundColor="#1A1A1D"
                   CornerRadius="12"
                   HasShadow="True"
                   BorderColor="#2D2D30"
                   Padding="0">
                <Grid Padding="20" RowSpacing="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!-- TÃTULO CON ICONO -->
                    <HorizontalStackLayout Grid.Row="0" Spacing="10" HorizontalOptions="Center">
                        <Label Text="ðŸŽ®" FontSize="28" VerticalOptions="Center" />
                        <Label Text="Buscar Enfrentamientos" 
                               FontSize="24" 
                               FontAttributes="Bold"
                               TextColor="#6C63FF"
                               VerticalOptions="Center" />
                    </HorizontalStackLayout>

                    <!-- GRID RESPONSIVO PARA JUGADORES Y MAPA -->
                    <Grid Grid.Row="1" ColumnSpacing="15" RowSpacing="15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- Jugador 1 -->
                        <VerticalStackLayout Grid.Column="0" Spacing="8">
                            <Label Text="âš”ï¸ Jugador 1" 
                                   FontAttributes="Bold"
                                   TextColor="#E0E0E0"
                                   FontSize="14" />
                            <Frame BackgroundColor="#252529" 
                                   BorderColor="#3E3E42" 
                                   CornerRadius="8" 
                                   Padding="0"
                                   HasShadow="False">
                                <Picker x:Name="PickerJugador1"
                                        ItemDisplayBinding="{Binding Alias}"
                                        TextColor="#FFFFFF"
                                        TitleColor="#999999"
                                        FontSize="15" 
                                        BackgroundColor="Transparent"/>
                            </Frame>
                        </VerticalStackLayout>

                        <!-- VS Label -->
                        <Label Grid.Column="1" 
                               Text="VS" 
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="#FF6B6B"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"
                               Margin="0,25,0,0" />

                        <!-- Jugador 2 -->
                        <VerticalStackLayout Grid.Column="2" Spacing="8">
                            <Label Text="âš”ï¸ Jugador 2" 
                                   FontAttributes="Bold"
                                   TextColor="#E0E0E0"
                                   FontSize="14" />
                            <Frame BackgroundColor="#252529" 
                                   BorderColor="#3E3E42" 
                                   CornerRadius="8" 
                                   Padding="0"
                                   HasShadow="False">
                                <Picker x:Name="PickerJugador2"
                                        ItemDisplayBinding="{Binding Alias}"
                                        TextColor="#FFFFFF"
                                        TitleColor="#999999"
                                        FontSize="15"
                                        BackgroundColor="Transparent"/>
                            </Frame>
                        </VerticalStackLayout>

                        <!-- Mapa -->
                        <VerticalStackLayout Grid.Column="3" Spacing="8">
                            <Label Text="ðŸ—ºï¸ Mapa" 
                                   FontAttributes="Bold"
                                   TextColor="#E0E0E0"
                                   FontSize="14" />
                            <Frame BackgroundColor="#252529" 
                                   BorderColor="#3E3E42" 
                                   CornerRadius="8" 
                                   Padding="0"
                                   HasShadow="False">
                                <Picker x:Name="PickerMapa"
                                        ItemDisplayBinding="{Binding Nombre}"
                                        TextColor="#FFFFFF"
                                        TitleColor="#999999"
                                        FontSize="15"
                                        BackgroundColor="Transparent"/>
                            </Frame>
                        </VerticalStackLayout>
                    </Grid>

                    <!-- FILTROS ADICIONALES -->
                    <Grid Grid.Row="2" ColumnSpacing="15" RowSpacing="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- Modalidad -->
                        <VerticalStackLayout Grid.Column="0" Spacing="8">
                            <Label Text="ðŸ† Modalidad" 
                                   FontAttributes="Bold"
                                   TextColor="#E0E0E0"
                                   FontSize="14" />
                            <Frame BackgroundColor="#252529" 
                                   BorderColor="#3E3E42" 
                                   CornerRadius="8" 
                                   Padding="12,8"
                                   HasShadow="False">
                                <Entry x:Name="EntryModalidad"
                                       Placeholder="Bo3, Bo5, Bo7..."
                                       PlaceholderColor="#808080"
                                       TextColor="#FFFFFF"
                                       BackgroundColor="Transparent"/>
                            </Frame>
                        </VerticalStackLayout>

                        <!-- Fecha Desde -->
                        <VerticalStackLayout Grid.Column="1" Spacing="8">
                            <Label Text="ðŸ“… Desde" 
                                   FontAttributes="Bold"
                                   TextColor="#E0E0E0"
                                   FontSize="14" />
                            <Frame BackgroundColor="#252529" 
                                   BorderColor="#3E3E42" 
                                   CornerRadius="8" 
                                   Padding="8,4"
                                   HasShadow="False">
                                <DatePicker x:Name="DateDesde" 
                                           TextColor="#FFFFFF"
                                           FontSize="14"
                                           BackgroundColor="Transparent"/>
                            </Frame>
                        </VerticalStackLayout>

                        <!-- Fecha Hasta -->
                        <VerticalStackLayout Grid.Column="2" Spacing="8">
                            <Label Text="ðŸ“… Hasta" 
                                   FontAttributes="Bold"
                                   TextColor="#E0E0E0"
                                   FontSize="14" />
                            <Frame BackgroundColor="#252529" 
                                   BorderColor="#3E3E42" 
                                   CornerRadius="8" 
                                   Padding="8,4"
                                   HasShadow="False">
                                <DatePicker x:Name="DateHasta" 
                                           TextColor="#FFFFFF"
                                           FontSize="14"
                                           BackgroundColor="Transparent"/>
                            </Frame>
                        </VerticalStackLayout>
                    </Grid>
                    <Grid Grid.Row="3" ColumnSpacing="15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <!-- BOTÃ“N BUSCAR -->
                        <Button Grid.Row="3"
                            Text="ðŸ” BUSCAR ENFRENTAMIENTOS"
                            BackgroundColor="#6C63FF"
                            TextColor="White"
                            FontAttributes="Bold"
                            FontSize="16"
                            CornerRadius="8"
                            HeightRequest="50"
                            Clicked="OnBuscarClicked">
                            <Button.Shadow>
                                <Shadow Brush="#6C63FF" Opacity="0.5" Radius="15" Offset="0,5" />
                            </Button.Shadow>
                        </Button>

                        <Button Grid.Column="1"
                        Text="ðŸ”„ Limpiar"
                        BackgroundColor="#3E3E42"
                        TextColor="White"
                        FontAttributes="Bold"
                        FontSize="15"
                        CornerRadius="8"
                        HeightRequest="50"
                        Clicked="LimpiarButton_Clicked">
                            <Button.Shadow>
                                <Shadow Brush="#3E3E42" Opacity="0.4" Radius="12" Offset="0,4" />
                            </Button.Shadow>
                        </Button>
                    </Grid>
                </Grid>
            </Frame>

            <!-- SECCIÃ“N DE RESULTADOS -->
            <Frame Grid.Row="1" 
                   BackgroundColor="#1A1A1D"
                   CornerRadius="12"
                   HasShadow="True"
                   BorderColor="#2D2D30"
                   Padding="20"
                   IsVisible="{Binding Source={x:Reference LblResumen}, Path=Text, Converter={StaticResource StringNullOrEmptyBoolConverter}}">
                <Grid RowSpacing="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!-- TÃTULO RESULTADOS -->
                    <Label Grid.Row="0"
                           Text="ðŸ“Š EstadÃ­sticas del Enfrentamiento"
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="#6C63FF" />

                    <!-- RESUMEN -->
                    <Frame Grid.Row="1" 
                           BackgroundColor="#252529"
                           BorderColor="#6C63FF"
                           CornerRadius="8"
                           Padding="15"
                           HasShadow="False">
                        <Label x:Name="LblResumen"
                               FontSize="16"
                               TextColor="#E0E0E0"
                               LineHeight="1.5" />
                    </Frame>

                    <!-- GRÃFICO -->
                    <Frame Grid.Row="2"
                           BackgroundColor="#252529"
                           BorderColor="#3E3E42"
                           CornerRadius="8"
                           Padding="10"
                           HasShadow="False">
                        <lvc:CartesianChart x:Name="chart"
                                            HeightRequest="350"
                                            BackgroundColor="#252529"/>
                    </Frame>
                </Grid>
            </Frame>

            <!-- LISTA DE JUEGOS -->
            <Frame Grid.Row="2"
                   BackgroundColor="#1A1A1D"
                   CornerRadius="12"
                   HasShadow="True"
                   BorderColor="#2D2D30"
                   Padding="20">
                <Grid RowSpacing="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Label Grid.Row="0"
                           Text="ðŸ“œ Historial de Juegos"
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="#6C63FF" />

                    <CollectionView Grid.Row="1" 
                                   x:Name="ListaResultados"
                                   SelectionMode="None">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Frame BackgroundColor="#252529"
                                       BorderColor="#3E3E42"
                                       CornerRadius="10"
                                       Padding="15"
                                       Margin="0,5"
                                       HasShadow="False">
                                    <Grid ColumnSpacing="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>

                                        <!-- Indicador visual -->
                                        <BoxView Grid.Column="0"
                                                 BackgroundColor="#6C63FF"
                                                 WidthRequest="4"
                                                 CornerRadius="2"
                                                 VerticalOptions="Fill" />

                                        <VerticalStackLayout Grid.Column="1" Spacing="6">
                                            <Label Text="{Binding SerieText}"
                                                   FontAttributes="Bold"
                                                   FontSize="15"
                                                   TextColor="#FFFFFF" />
                                            <Label Text="{Binding JuegoText}"
                                                   FontSize="14"
                                                   TextColor="#B8B8B8" />
                                            <Label Text="{Binding FechaCreacion, StringFormat='ðŸ•’ {0:dd/MM/yyyy HH:mm}'}"
                                                   FontSize="12"
                                                   TextColor="#808080" />
                                        </VerticalStackLayout>
                                    </Grid>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </Grid>
            </Frame>
        </Grid>
    </ScrollView>
</ContentPage>